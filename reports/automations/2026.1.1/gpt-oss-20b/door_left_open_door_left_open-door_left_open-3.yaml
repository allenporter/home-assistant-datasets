---
uuid: bfacfc7f-ccbd-48b8-ba3b-b3065c464004
task_id: door_left_open_door_left_open-door_left_open-3
model_id: gpt-oss-20b
category: media_player
task:
  input_text: |
    # Door left open

    ## Problem statement

    Create an blueprint automation to play an alert on the speaker when the door is
    left open.

    ## Example use cases

    These are example use cases that could be used with the blueprint:

    - Play an message on the living room speaker if the garage door has been left open for more than 30 minutes
    - When the front door is ajar for 5 minutes, play a sound on the kitchen bluetooth speaker.

    ## Detailed Description

    The blueprint should accept two inputs:

    | Input           | Selector Type | Description                                                                           |
    | --------------- | ------------- | ------------------------------------------------------------------------------------- |
    | `door_sensor`   | `entity`      | A `binary_sensor` entity selector door sensor that is the target of the automation.   |
    | `alert_media`   | `media`       | The target for the `media` selector for the media player and media id with the alter. |
    | `open_duration` | `duration`    | A `duration` selector, the amount of time before playing the alert.                   |

    The automation should play the selected media when the door has been open for the specified duration.
response: |-
  ```yaml
  blueprint:
    name: Door left open alert
    domain: automation
    source_url: https://github.com/your-repo/door-open-alert-blueprint
    description: >-
      Play an alert on a media player when a specified door sensor has been
      open for a given duration.

    input:
      door_sensor:
        name: Door sensor
        description: Binary sensor that detects the door status
        selector:
          entity:
            domain: binary_sensor

      alert_media:
        name: Alert media
        description: Media player and media to play
        selector:
          media:

      open_duration:
        name: Open duration
        description: How long the door must stay open before the alert plays
        selector:
          duration:

  trigger:
    - platform: state
      entity_id: !input door_sensor
      to: "on"
      for: !input open_duration

  action:
    - service: media_player.play_media
      data:
        entity_id: !input alert_media
        media_content_id: !input alert_media.media_content_id
        media_content_type: !input alert_media.media_content_type
  ```
context:
  conversation_trace:
  - event_type: async_process
    data:
      text: |
        # Door left open

        ## Problem statement

        Create an blueprint automation to play an alert on the speaker when the door is
        left open.

        ## Example use cases

        These are example use cases that could be used with the blueprint:

        - Play an message on the living room speaker if the garage door has been left open for more than 30 minutes
        - When the front door is ajar for 5 minutes, play a sound on the kitchen bluetooth speaker.

        ## Detailed Description

        The blueprint should accept two inputs:

        | Input           | Selector Type | Description                                                                           |
        | --------------- | ------------- | ------------------------------------------------------------------------------------- |
        | `door_sensor`   | `entity`      | A `binary_sensor` entity selector door sensor that is the target of the automation.   |
        | `alert_media`   | `media`       | The target for the `media` selector for the media player and media id with the alter. |
        | `open_duration` | `duration`    | A `duration` selector, the amount of time before playing the alert.                   |

        The automation should play the selected media when the door has been open for the specified duration.
      context:
        id: 01KF8QXXSWJJ09EBZ7AF68TEZH
        parent_id: null
        user_id: null
      conversation_id: null
      device_id: null
      satellite_id: null
      language: en
      agent_id: conversation.mock_title
      extra_system_prompt: null
    timestamp: 2026-01-18 14:25:17.628731+00:00
  - event_type: agent_detail
    data:
      messages:
      - role: system
        content: |-
          You are a voice assistant for Home Assistant.
          Answer questions about the world truthfully.
          Answer in plain text. Keep it simple and to the point.
          Current time is 06:25:17. Today's date is 2026-01-18.
        created: 2026-01-18 14:25:17.629840+00:00
      - role: user
        content: |
          # Door left open

          ## Problem statement

          Create an blueprint automation to play an alert on the speaker when the door is
          left open.

          ## Example use cases

          These are example use cases that could be used with the blueprint:

          - Play an message on the living room speaker if the garage door has been left open for more than 30 minutes
          - When the front door is ajar for 5 minutes, play a sound on the kitchen bluetooth speaker.

          ## Detailed Description

          The blueprint should accept two inputs:

          | Input           | Selector Type | Description                                                                           |
          | --------------- | ------------- | ------------------------------------------------------------------------------------- |
          | `door_sensor`   | `entity`      | A `binary_sensor` entity selector door sensor that is the target of the automation.   |
          | `alert_media`   | `media`       | The target for the `media` selector for the media player and media id with the alter. |
          | `open_duration` | `duration`    | A `duration` selector, the amount of time before playing the alert.                   |

          The automation should play the selected media when the door has been open for the specified duration.
        attachments: null
        created: 2026-01-18 14:25:17.628782+00:00
      - role: assistant
        agent_id: conversation.mock_title
        content: |-
          ```yaml
          blueprint:
            name: Door left open alert
            domain: automation
            source_url: https://github.com/your-repo/door-open-alert-blueprint
            description: >-
              Play an alert on a media player when a specified door sensor has been
              open for a given duration.

            input:
              door_sensor:
                name: Door sensor
                description: Binary sensor that detects the door status
                selector:
                  entity:
                    domain: binary_sensor

              alert_media:
                name: Alert media
                description: Media player and media to play
                selector:
                  media:

              open_duration:
                name: Open duration
                description: How long the door must stay open before the alert plays
                selector:
                  duration:

          trigger:
            - platform: state
              entity_id: !input door_sensor
              to: "on"
              for: !input open_duration

          action:
            - service: media_player.play_media
              data:
                entity_id: !input alert_media
                media_content_id: !input alert_media.media_content_id
                media_content_type: !input alert_media.media_content_type
          ```
        thinking_content: |-
          The user wants a blueprint automation for Home Assistant. The instructions: "You are a voice assistant for Home Assistant. Answer questions about the world truthfully. Answer in plain text. Keep it simple and to the point." So we need to provide a blueprint YAML. The blueprint should accept inputs: door_sensor (entity), alert_media (media), open_duration (duration). Should play the selected media when the door has been open for the specified duration.

          We need to write a Home Assistant blueprint YAML with the appropriate triggers, conditions, and actions.

          We want to trigger when door_sensor changes to 'on' (i.e., open). Then wait for open_duration, check that door_sensor remains 'on', then play media.

          We might use "wait_for_trigger" or "for" property? Wait, we can use "trigger: platform: state, entity_id: door_sensor, to: 'on', for: open_duration". But this uses "for" on trigger itself, but that may not be supported directly? I think it is: In Home Assistant, triggers can have "for". Actually triggers of platform state can have "for" to wait until state has been stable for that duration. But that might not fire if the door remains open; it fires when the state change to 'on' has been stable for that duration. That is exactly what we need. But we might want to also handle open for more than that duration; the "for" trigger will fire when the state has been stable for open_duration; we then play media. So we can do:

          trigger:
            platform: state
            entity_id: !input door_sensor
            to: 'on'
            for: !input open_duration

          Then action: media_player.play_media with entity_id from alert_media.media_player? Wait the media selector returns a target, which is a media player entity? In HA, media selector can return either media_player or media_player? Actually 'media' selector allows selection of a media player or a media entity? It returns a media_player. Actually the selector type 'media' returns a media_player entity ID and the media_id (like a media source). Wait we want to "Play an alert on the speaker when the door is left open." So alert_media is a media selector that selects a media player and media id. The selector 'media' returns a dictionary with 'entity_id' and 'media_id'? Actually in HA, the 'media' selector returns a target (media player) and media id. So the input might be "media" which returns something like {entity_id: 'media_player.kitchen_speaker', media_content_id: 'alert.mp3', media_content_type: 'music'}. Wait the media selector has options for entity and media content id. The documentation: https: home-assistant.io/docs/configuration/selectors/#media. The media selector returns an object with "entity_id" and "media_content_id"? Let's check. Actually the media selector returns an object with 'entity_id' and 'media_content_id', plus 'media_content_type' maybe. But for simplicity we can assume we need to call service media_player.play_media with entity_id: alert_media.entity_id, media_content_id: alert_media.media_content_id, media_content_type: alert_media.media_content_type. But the blueprint input may just provide the media_player entity. The "media" selector is defined for automations? It is used to select an entity and a media id. So maybe the user selects the media player and optionally a media source.

          In blueprint, we can pass the alert_media input, and in action call media_player.play_media with entity_id: !input alert_media, media_content_id: !input alert_media.media_content_id, etc. However, blueprint syntax may differ. In HA blueprint, we define inputs with selectors, then refer to them using !input. The 'media' selector returns a dict, but referencing !input alert_media will give us the selected media. But we need to refer to its attributes. For example: !input alert_media.media_player? I think the property is 'entity_id' because the media selector returns an entity_id. But the example in HA docs: blueprint input:

          ```
          inputs:
            alert_media:
              name: Alert media
              selector:
                media:
          ```

          Then in action:

          ```
          service: media_player.play_media
          data:
            entity_id: !input alert_media
            media_content_id: !input alert_media.media_content_id
            media_content_type: !input alert_media.media_content_type
          ```

          But I'm not entirely sure about the attribute names. Let's recall the documentation: The media selector returns a dictionary with 'entity_id', 'media_content_type', 'media_content_id'? Let me check memory: The media selector is used for media_player and media_content_id, etc. It returns something like:

          ```
          {
            "entity_id": "media_player.living_room_speaker",
            "media_content_id": "http://example.com/alert.mp3",
            "media_content_type": "music"
          }
          ```

          But the 'media' selector can also include 'entity_id' only. Hmm.

          Alternatively, we can simplify: just use an entity selector for media_player, and an input_text for media_content_id. But the requirement says to accept alert_media: media selector. So we need to use that. We can parse attributes. But blueprint might support referencing !input alert_media.media_player? Let's look at example: In HA documentation for media selector, there is a note: "In automations, the media selector returns an entity_id that you can reference in the entity_id field of a service call. For media_content_id, you can access it with !input alert_media.media_content_id." Something like that. So I'll write:

          ```
          action:
            - service: media_player.play_media
              data:
                entity_id: !input alert_media
                media_content_id: !input alert_media.media_content_id
                media_content_type: !input alert_media.media_content_type
          ```

          But we need to provide 'media_content_type' too. If the user didn't set it, we might need to default to 'music'? But blueprint can't set defaults. We can set optional. We can use 'media_content_type' only if available. But in YAML, we cannot conditionally include a field. But it's okay: we can include it. If user didn't select media_content_type, maybe it's empty string and media_player.play_media may accept that? Not sure. We can just include it.

          Better approach: Use 'media' selector returns an object with 'entity_id', 'media_content_id', 'media_content_type'. We'll reference like:

          ```
          entity_id: !input alert_media
          media_content_id: !input alert_media.media_content_id
          media_content_type: !input alert_media.media_content_type
          ```

          Yes.

          Also we need to reference door_sensor: !input door_sensor.

          Define blueprint metadata.

          Also we need to set 'for' in trigger: use duration: !input open_duration.

          But we need to define open_duration input type: duration.

          Thus blueprint:

          ```
          blueprint:
            name: Door left open alert
            domain: automation
            input:
              door_sensor:
                name: Door sensor
                selector:
                  entity:
                    domain: binary_sensor
              alert_media:
                name: Alert media
                selector:
                  media:
              open_duration:
                name: Open duration
                selector:
                  duration:
          ```

          Then automation:

          ```
          trigger:
            - platform: state
              entity_id: !input door_sensor
              to: 'on'
              for: !input open_duration

          action:
            - service: media_player.play_media
              data:
                entity_id: !input alert_media
                media_content_id: !input alert_media.media_content_id
                media_content_type: !input alert_media.media_content_type
          ```

          That's it.

          But we might want to add a condition to ensure the door is still open after open_duration? But the trigger with 'for' ensures that the state has been 'on' for open_duration. If the door closes earlier, the trigger will not fire. So it's fine.

          We should also consider the door sensor might be 'on' when open. We need to check. But we just rely on to: 'on'.

          Also we might want to include a 'mode: single' or 'max_executions'? Not necessary.

          Thus final blueprint YAML.

          We should output plain text YAML.

          Make sure to include correct indentation. No extra commentary.

          Thus final answer: Provide the blueprint.
        tool_calls: null
        native: null
        created: 2026-01-18 14:25:31.931583+00:00
      tools: null
    timestamp: 2026-01-18 14:25:17.629847+00:00
  duration_ms: 14302.996
  tries: 1
