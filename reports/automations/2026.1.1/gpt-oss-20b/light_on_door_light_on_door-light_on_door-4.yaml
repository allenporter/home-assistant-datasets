---
uuid: 08ced9a8-e1af-4924-a35b-1e9848501f0d
task_id: light_on_door_light_on_door-light_on_door-4
model_id: gpt-oss-20b
category: light
task:
  input_text: |
    # Light on door

    ## Problem statement

    Create an blueprint automation to turn on a light when the door opens.

    ## Example use cases

    These are example use cases that could be used with the blueprint:

    - Turn on the pantry light when the pantry door opens

    ## Detailed Description

    The blueprint should accept two inputs:

    | Input          | Description                                                                     |
    | -------------- | ------------------------------------------------------------------------------- |
    | `door_sensor`  | A `binary_sensor` that triggers the automation to start.                        |
    | `light_switch` | One or more `light` entity targets to turn on or off when the automation fires. |

    The automation should trigger when the door opens, and turn the light on. The
    light should be shut off when the door closes or after a 2 minute timeout.
response: "Below is a ready‑to‑use Home Assistant automation blueprint.  \nSave it\
  \ as `light_on_door.yaml` (or any name you like) inside your `config/blueprints/automation/`\
  \ folder, then import it via the UI.\n\n```yaml\nblueprint:\n  name: Light on door\n\
  \  description: |\n    Turns a light on when a door opens and turns it off\n   \
  \ either when the door closes or after 2 minutes.\n  domain: automation\n  input:\n\
  \    door_sensor:\n      name: Door sensor\n      selector:\n        entity:\n \
  \         domain: binary_sensor\n    light_switch:\n      name: Light switch\n \
  \     selector:\n        entity:\n          domain: light\n          multiple: true\n\
  \ntrigger:\n  - platform: state\n    entity_id: !input door_sensor\n    to: 'on'\n\
  \naction:\n  - service: light.turn_on\n    target: !input light_switch\n\n  - wait_for_trigger:\n\
  \      - platform: state\n        entity_id: !input door_sensor\n        to: 'off'\n\
  \    timeout: 120  # 2 minutes\n    continue_on_timeout: true\n\n  - service: light.turn_off\n\
  \    target: !input light_switch\n```\n\n### How it works\n1. **Trigger** – The\
  \ automation starts when the binary sensor (`door_sensor`) changes to the “on” state\
  \ (door opens).\n2. **Turn on** – The specified light(s) (`light_switch`) are turned\
  \ on immediately.\n3. **Wait** – The automation waits for either:\n   * The door\
  \ sensor to change to “off” (door closes), **or**\n   * A timeout of 120 seconds\
  \ (2 minutes) if the door remains open.\n4. **Turn off** – When either event occurs,\
  \ the light(s) are turned off.\n\nThis blueprint is straightforward and works for\
  \ any number of lights you select."
context:
  conversation_trace:
  - event_type: async_process
    data:
      text: |
        # Light on door

        ## Problem statement

        Create an blueprint automation to turn on a light when the door opens.

        ## Example use cases

        These are example use cases that could be used with the blueprint:

        - Turn on the pantry light when the pantry door opens

        ## Detailed Description

        The blueprint should accept two inputs:

        | Input          | Description                                                                     |
        | -------------- | ------------------------------------------------------------------------------- |
        | `door_sensor`  | A `binary_sensor` that triggers the automation to start.                        |
        | `light_switch` | One or more `light` entity targets to turn on or off when the automation fires. |

        The automation should trigger when the door opens, and turn the light on. The
        light should be shut off when the door closes or after a 2 minute timeout.
      context:
        id: 01KF8R25T04P3T5NJHHPCQJFXK
        parent_id: null
        user_id: null
      conversation_id: null
      device_id: null
      satellite_id: null
      language: en
      agent_id: conversation.mock_title
      extra_system_prompt: null
    timestamp: 2026-01-18 14:27:36.897046+00:00
  - event_type: agent_detail
    data:
      messages:
      - role: system
        content: |-
          You are a voice assistant for Home Assistant.
          Answer questions about the world truthfully.
          Answer in plain text. Keep it simple and to the point.
          Current time is 06:27:36. Today's date is 2026-01-18.
        created: 2026-01-18 14:27:36.898139+00:00
      - role: user
        content: |
          # Light on door

          ## Problem statement

          Create an blueprint automation to turn on a light when the door opens.

          ## Example use cases

          These are example use cases that could be used with the blueprint:

          - Turn on the pantry light when the pantry door opens

          ## Detailed Description

          The blueprint should accept two inputs:

          | Input          | Description                                                                     |
          | -------------- | ------------------------------------------------------------------------------- |
          | `door_sensor`  | A `binary_sensor` that triggers the automation to start.                        |
          | `light_switch` | One or more `light` entity targets to turn on or off when the automation fires. |

          The automation should trigger when the door opens, and turn the light on. The
          light should be shut off when the door closes or after a 2 minute timeout.
        attachments: null
        created: 2026-01-18 14:27:36.897096+00:00
      - role: assistant
        agent_id: conversation.mock_title
        content: "Below is a ready‑to‑use Home Assistant automation blueprint.  \n\
          Save it as `light_on_door.yaml` (or any name you like) inside your `config/blueprints/automation/`\
          \ folder, then import it via the UI.\n\n```yaml\nblueprint:\n  name: Light\
          \ on door\n  description: |\n    Turns a light on when a door opens and\
          \ turns it off\n    either when the door closes or after 2 minutes.\n  domain:\
          \ automation\n  input:\n    door_sensor:\n      name: Door sensor\n    \
          \  selector:\n        entity:\n          domain: binary_sensor\n    light_switch:\n\
          \      name: Light switch\n      selector:\n        entity:\n          domain:\
          \ light\n          multiple: true\n\ntrigger:\n  - platform: state\n   \
          \ entity_id: !input door_sensor\n    to: 'on'\n\naction:\n  - service: light.turn_on\n\
          \    target: !input light_switch\n\n  - wait_for_trigger:\n      - platform:\
          \ state\n        entity_id: !input door_sensor\n        to: 'off'\n    timeout:\
          \ 120  # 2 minutes\n    continue_on_timeout: true\n\n  - service: light.turn_off\n\
          \    target: !input light_switch\n```\n\n### How it works\n1. **Trigger**\
          \ – The automation starts when the binary sensor (`door_sensor`) changes\
          \ to the “on” state (door opens).\n2. **Turn on** – The specified light(s)\
          \ (`light_switch`) are turned on immediately.\n3. **Wait** – The automation\
          \ waits for either:\n   * The door sensor to change to “off” (door closes),\
          \ **or**\n   * A timeout of 120 seconds (2 minutes) if the door remains\
          \ open.\n4. **Turn off** – When either event occurs, the light(s) are turned\
          \ off.\n\nThis blueprint is straightforward and works for any number of\
          \ lights you select."
        thinking_content: |-
          We need to provide a blueprint for Home Assistant automation. Inputs: door_sensor (binary_sensor), light_switch (light). It should trigger when door opens, turn light on. Then shut off when door closes or after 2 minute timeout. So blueprint YAML.

          We need to include "automation" blueprint. Provide input definitions, trigger, action, etc. Use wait_for_trigger for closing or timeout.

          Better blueprint:

          ```
          blueprint:
            name: Light on door
            description: Turn on light when door opens, turn off when closes or after timeout
            domain: automation
            input:
              door_sensor:
                name: Door sensor
                selector:
                  entity:
                    domain: binary_sensor
              light_switch:
                name: Light switch
                selector:
                  entity:
                    domain: light
                    multiple: true
            trigger:
              platform: state
              entity_id: !input door_sensor
              to: 'on'
            action:
              - service: light.turn_on
                target: !input light_switch
              - wait_for_trigger:
                  - platform: state
                    entity_id: !input door_sensor
                    to: 'off'
                timeout: 120
                continue_on_timeout: true
              - service: light.turn_off
                target: !input light_switch
          ```

          Need to handle that wait_for_trigger may not find the close event, so after timeout, continues.

          Make sure to use continue_on_timeout: true.

          Alternatively use two triggers: open triggers to turn on, and close triggers to turn off. But also need 2 minute timer. The above blueprint uses wait_for_trigger.

          Also ensure light.turn_off is called when the door closes or after timeout.

          Edge cases: door opens, light turns on, if door closes before 2 minutes, wait_for_trigger triggers, service off. If door stays open, after 2 minutes, timeout triggers, service off.

          Potential need to cancel previous timer if door opens again? Not necessary.

          Should we include a condition to check light state? No.

          Return blueprint in YAML.

          Also need to provide plain text. Provide blueprint code.

          Make sure we use the proper syntax: `!input` is correct.

          Use `timeout: 120` or `timeout: 00:02:00`? In HA, timeout in seconds or time string. 120 seconds is fine.

          Use `continue_on_timeout: true`.

          Return blueprint.

          Also may include "max_concurrency" if needed, but not required.

          Will output YAML. Also mention that the blueprint is for Home Assistant automation, not the entire config.

          Let's produce final.
        tool_calls: null
        native: null
        created: 2026-01-18 14:27:43.634786+00:00
      tools: null
    timestamp: 2026-01-18 14:27:36.898147+00:00
  duration_ms: 6737.882
  tries: 1
